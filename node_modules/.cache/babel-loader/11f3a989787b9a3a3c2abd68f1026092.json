{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/LENOVO/Downloads/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/LENOVO/Downloads/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"C:/Users/LENOVO/Downloads/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/LENOVO/Downloads/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/LENOVO/Downloads/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _styled from\"styled-components\";import React,{useContext,useEffect,useState}from'react';import axios from'axios';import{useNavigate}from'react-router-dom';import userContext from'../../Context/userContext';import NavbarComp from'../Navbar/NavbarComp';import{Button,Form}from'react-bootstrap';import{Link}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var LoginContainer=_styled.main.withConfig({displayName:\"Login__LoginContainer\",componentId:\"sc-10hz44s-0\"})([\"height:90vh;\"]);var ErrorBox=_styled.div.withConfig({displayName:\"Login__ErrorBox\",componentId:\"sc-10hz44s-1\"})([\"height:30px;margin:1rem 0;color:red;text-align:center;\"]);var LeftContainer=_styled.div.withConfig({displayName:\"Login__LeftContainer\",componentId:\"sc-10hz44s-2\"})([\"display:flex;flex-direction:column;justify-content:center;padding:0 1rem;align-items:flex-end;float:left;width:50%;height:100%;@media (max-width:800px){width:100%;}\"]);var Footer=_styled.footer.withConfig({displayName:\"Login__Footer\",componentId:\"sc-10hz44s-3\"})([\"background-color:#212529;height:3.6vh;\"]);var FormWrapper=_styled.div.withConfig({displayName:\"Login__FormWrapper\",componentId:\"sc-10hz44s-4\"})([\"width:60%;@media (max-width:800px){width:100%;}\"]);var RightContainer=_styled.div.withConfig({displayName:\"Login__RightContainer\",componentId:\"sc-10hz44s-5\"})([\"float:right;width:50%;display:flex;justify-content:center;align-items:center;height:100%;img{width:100%;max-width:800px;}@media (max-width:800px){display:none;}\"]);export default function Login(){var _useState=useState({loginId:'',password:''}),_useState2=_slicedToArray(_useState,2),formData=_useState2[0],setFormData=_useState2[1];var loginId=formData.loginId,password=formData.password;var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),errorMessage=_useState6[0],setErrorMessage=_useState6[1];var navigate=useNavigate();var _useContext=useContext(userContext),userData=_useContext.userData,setUserData=_useContext.setUserData;var onChange=function onChange(e){setFormData(function(prevState){return _objectSpread(_objectSpread({},prevState),{},_defineProperty({},e.target.name,e.target.value));});};var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var URL,postData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();if(!loginId||!password){setError(true);setErrorMessage('Fields cannot be empty!');}if(!(loginId&&password)){_context.next=8;break;}setError(false);//const URL = 'http://localhost:8081/api/v1.0/moviebooking/login'\nURL='https://movieapp-danish.azurewebsites.net/login';postData={loginId:loginId,password:password};_context.next=8;return axios.post(URL,postData).then(function(response){setError(false);console.log(response.data);var accessToken=response.data.accessToken;var roles=response.data.roles;//console.log(roles)\nif(accessToken){var user={accessToken:accessToken,roles:roles};setUserData(user);localStorage.setItem('user',JSON.stringify(response.data));//console.log(user?.roles)\nif((user===null||user===void 0?void 0:user.roles[0])==='ROLE_ADMIN')navigate('/forAdmin');if((user===null||user===void 0?void 0:user.roles[0])==='ROLE_USER')navigate('/forUser');//console.log(user?.roles[0])\n//console.log(user)\n}}).catch(function(error){setError(true);setErrorMessage('Invalid Credentials!');setFormData({password:''});console.log(error);});case 8:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();useEffect(function(){if(localStorage.getItem('user')){setUserData(localStorage.getItem('user'));}},[userData]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(NavbarComp,{}),/*#__PURE__*/_jsxs(LoginContainer,{children:[/*#__PURE__*/_jsx(LeftContainer,{children:/*#__PURE__*/_jsx(FormWrapper,{children:/*#__PURE__*/_jsxs(Form,{children:[/*#__PURE__*/_jsxs(Form.Group,{controlId:\"formBasicEmail\",className:\"mb-4\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Username\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Username\",name:\"loginId\",value:loginId||'',onChange:onChange,required:true})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"formBasicPassword\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Password\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"password\",placeholder:\"Password\",name:\"password\",value:password||'',onChange:onChange,required:true})]}),/*#__PURE__*/_jsx(ErrorBox,{children:errorMessage}),/*#__PURE__*/_jsx(\"div\",{className:\"d-grid \",children:/*#__PURE__*/_jsx(Button,{className:\"btn btn-primary\",type:\"button\",onClick:handleSubmit,children:\"Login\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"d-grid \",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"Don't have an account? \",/*#__PURE__*/_jsx(Link,{to:\"/signup\",children:\"Sign Up\"})]})})]})})}),/*#__PURE__*/_jsx(RightContainer,{children:/*#__PURE__*/_jsx(\"img\",{src:\"login.jpg\",alt:\"logo\"})})]}),/*#__PURE__*/_jsx(Footer,{})]});}","map":{"version":3,"names":["React","useContext","useEffect","useState","axios","useNavigate","userContext","NavbarComp","Button","Form","Link","LoginContainer","styled","main","ErrorBox","div","LeftContainer","Footer","footer","FormWrapper","RightContainer","Login","loginId","password","formData","setFormData","error","setError","errorMessage","setErrorMessage","navigate","userData","setUserData","onChange","e","prevState","target","name","value","handleSubmit","preventDefault","URL","postData","post","then","response","console","log","data","accessToken","roles","user","localStorage","setItem","JSON","stringify","catch","getItem"],"sources":["C:/Users/LENOVO/Downloads/frontend/src/Components/Login/Login.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from 'react'\r\nimport styled from 'styled-components/macro'\r\nimport axios from 'axios'\r\nimport { useNavigate } from 'react-router-dom'\r\nimport userContext from '../../Context/userContext'\r\nimport NavbarComp from '../Navbar/NavbarComp'\r\nimport { Button, Form } from 'react-bootstrap'\r\nimport { Link } from 'react-router-dom'\r\n\r\nconst LoginContainer = styled.main`\r\n  /* border: 1px solid red; */\r\n  height: 90vh;\r\n`\r\n\r\nconst ErrorBox = styled.div`\r\n  height: 30px;\r\n  margin: 1rem 0;\r\n  color: red;\r\n  text-align: center;\r\n`\r\nconst LeftContainer = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  padding: 0 1rem;\r\n  align-items: flex-end;\r\n  float: left;\r\n  width: 50%;\r\n  height: 100%;\r\n\r\n  @media (max-width: 800px) {\r\n    width: 100%;\r\n  }\r\n`\r\nconst Footer = styled.footer`\r\n  background-color: #212529;\r\n  height: 3.6vh;\r\n`\r\nconst FormWrapper = styled.div`\r\n  width: 60%;\r\n\r\n  @media (max-width: 800px) {\r\n    width: 100%;\r\n  }\r\n`\r\n\r\nconst RightContainer = styled.div`\r\n  float: right;\r\n  width: 50%;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  /* border: 1px solid purple; */\r\n  height: 100%;\r\n  img {\r\n    width: 100%;\r\n    max-width: 800px;\r\n  }\r\n\r\n  @media (max-width: 800px) {\r\n    display: none;\r\n      \r\n  }\r\n`\r\n\r\nexport default function Login() {\r\n  const [formData, setFormData] = useState({\r\n    loginId: '',\r\n    password: '',\r\n  })\r\n\r\n  const { loginId, password } = formData\r\n\r\n  const [error, setError] = useState(false)\r\n  const [errorMessage, setErrorMessage] = useState('')\r\n\r\n  let navigate = useNavigate()\r\n\r\n  const { userData, setUserData } = useContext(userContext)\r\n\r\n  const onChange = (e) => {\r\n    setFormData((prevState) => ({\r\n      ...prevState,\r\n      [e.target.name]: e.target.value,\r\n    }))\r\n  }\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault()\r\n\r\n    if (!loginId || !password) {\r\n      setError(true)\r\n      setErrorMessage('Fields cannot be empty!')\r\n    }\r\n    if (loginId && password) {\r\n      setError(false)\r\n      //const URL = 'http://localhost:8081/api/v1.0/moviebooking/login'\r\n      const URL = 'https://movieapp-danish.azurewebsites.net/login'\r\n      const postData = { loginId: loginId, password: password }\r\n\r\n      await axios\r\n        .post(URL, postData)\r\n        .then((response) => {\r\n          setError(false)\r\n          console.log(response.data)\r\n          const accessToken = response.data.accessToken\r\n          const roles = response.data.roles\r\n          //console.log(roles)\r\n          if (accessToken) {\r\n            const user = { accessToken, roles }\r\n            setUserData(user)\r\n            localStorage.setItem('user', JSON.stringify(response.data))\r\n            //console.log(user?.roles)\r\n            if (user?.roles[0] === 'ROLE_ADMIN') navigate('/forAdmin')\r\n            if (user?.roles[0] === 'ROLE_USER') navigate('/forUser')\r\n            //console.log(user?.roles[0])\r\n            //console.log(user)\r\n          }\r\n        })\r\n        .catch((error) => {\r\n          setError(true)\r\n          setErrorMessage('Invalid Credentials!')\r\n          setFormData({ password: '' })\r\n          console.log(error)\r\n        })\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (localStorage.getItem('user')) {\r\n      setUserData(localStorage.getItem('user'))\r\n    }\r\n  }, [userData])\r\n\r\n  return (\r\n    <>\r\n      <NavbarComp />\r\n      <LoginContainer>\r\n        <LeftContainer>\r\n          <FormWrapper>\r\n            <Form>\r\n              <Form.Group controlId='formBasicEmail' className='mb-4'>\r\n                <Form.Label>Username</Form.Label>\r\n                <Form.Control\r\n                  type='text'\r\n                  placeholder='Username'\r\n                  name='loginId'\r\n                  value={loginId || ''}\r\n                  onChange={onChange}\r\n                  required\r\n                />\r\n              </Form.Group>\r\n\r\n              <Form.Group controlId='formBasicPassword'>\r\n                <Form.Label>Password</Form.Label>\r\n                <Form.Control\r\n                  type='password'\r\n                  placeholder='Password'\r\n                  name='password'\r\n                  value={password || ''}\r\n                  onChange={onChange}\r\n                  required\r\n                />\r\n              </Form.Group>\r\n              <ErrorBox>{errorMessage}</ErrorBox>\r\n              <div className='d-grid '>\r\n                <Button\r\n                  className='btn btn-primary'\r\n                  type='button'\r\n                  onClick={handleSubmit}\r\n                >\r\n                  Login\r\n                </Button>\r\n              </div>\r\n              <div className='d-grid '>\r\n                <p>\r\n                  Don't have an account? <Link to='/signup'>Sign Up</Link>\r\n                </p>\r\n              </div>\r\n            </Form>\r\n          </FormWrapper>\r\n        </LeftContainer>\r\n\r\n        <RightContainer>\r\n          <img src='login.jpg' alt='logo' />\r\n        </RightContainer>\r\n      </LoginContainer>\r\n      <Footer></Footer>\r\n    </>\r\n  )\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}