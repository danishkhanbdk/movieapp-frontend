{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/LENOVO/Downloads/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/LENOVO/Downloads/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/LENOVO/Downloads/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _styled from\"styled-components\";import React,{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import NavbarComp from'../Navbar/NavbarComp';import{createAxios,getTokenFromLocalStorage}from'../../Hooks/UseAxios';import Table from'react-bootstrap/Table';import'react-pro-sidebar/dist/css/styles.css';import{Button}from'react-bootstrap';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Container=_styled.section.withConfig({displayName:\"Bookings__Container\",componentId:\"sc-vhn2yw-0\"})([\"max-width:1000px;margin:0 auto;box-sizing:border-box;margin-top:8rem;\"]);var LeftContainer=_styled.div.withConfig({displayName:\"Bookings__LeftContainer\",componentId:\"sc-vhn2yw-1\"})([\"display:flex;flex-direction:column;justify-content:center;padding:0 1rem;align-items:flex-end;float:left;width:50%;height:100%;margin-top:8rem;@media (max-width:800px){width:100%;}\"]);var RightContainer=_styled.div.withConfig({displayName:\"Bookings__RightContainer\",componentId:\"sc-vhn2yw-2\"})([\"float:right;width:50%;display:flex;justify-content:center;margin-top:8rem;align-items:center;height:100%;img{width:100%;max-width:800px;}@media (max-width:800px){display:none;}\"]);export default function AllTicket(){var navigate=useNavigate();var token=getTokenFromLocalStorage();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),errorMessage=_useState4[0],setErrorMessage=_useState4[1];//check user role\nvar user=localStorage.getItem('user');var parsedUser=JSON.parse(user);var userRole=parsedUser===null||parsedUser===void 0?void 0:parsedUser.roles[0];useEffect(function(){if(!user||userRole!=='ROLE_ADMIN'){navigate('/');}},[userRole]);var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),movies=_useState6[0],setMovies=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),tickets=_useState8[0],setTickets=_useState8[1];// useEffect(() => {\n//   fetchMovies();\n// }, []);\nvar fetchMovies=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var accessToken,apiUrl,authAxios,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0://  try {\n//   const response = await axios.get('http://localhost:8081/api/v1.0/moviebooking/all')\n//   setMovies(response.data?.data);\n//  } catch(error){\n//   console.log(error);\n//  }\naccessToken=parsedUser===null||parsedUser===void 0?void 0:parsedUser.accessToken;//console.log(accessToken)\napiUrl='http://localhost:8081/api/v1.0/moviebooking';authAxios=createAxios(apiUrl,accessToken);_context.next=5;return authAxios.get('/all',{validateStatus:function validateStatus(status){return status<500;}});case 5:data=_context.sent;setMovies(data===null||data===void 0?void 0:data.data);case 7:case\"end\":return _context.stop();}}},_callee);}));return function fetchMovies(){return _ref.apply(this,arguments);};}();useEffect(function(){fetchMovies();},[]);var fetchTickets=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(movieName){var accessToken,apiUrl,authAxios,data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:accessToken=parsedUser===null||parsedUser===void 0?void 0:parsedUser.accessToken;//console.log(accessToken)\napiUrl='https://movieapp-danish.azurewebsites.net/';authAxios=createAxios(apiUrl,accessToken);_context2.next=5;return authAxios.get(\"/getallbookedtickets/\".concat(movieName),{validateStatus:function validateStatus(status){return status<500;}});case 5:data=_context2.sent;setTickets(data===null||data===void 0?void 0:data.data);case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function fetchTickets(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(NavbarComp,{}),/*#__PURE__*/_jsx(RightContainer,{children:/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,hover:true,variant:\"light\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Movie Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Theatre Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Tickets \"}),/*#__PURE__*/_jsx(\"th\",{children:\"Seat Numbers\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:tickets===null||tickets===void 0?void 0:tickets.map(function(item,index){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:item.loginId}),/*#__PURE__*/_jsx(\"td\",{children:item.movieName}),/*#__PURE__*/_jsx(\"td\",{children:item.theatreName}),/*#__PURE__*/_jsx(\"td\",{children:item.noOfTickets}),/*#__PURE__*/_jsx(\"td\",{children:Array.isArray(item.seatNumber)?item.seatNumber.join(', '):'N/A'})]},index);})})]})}),/*#__PURE__*/_jsx(LeftContainer,{children:/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,hover:true,variant:\"light\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Movie Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Action\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:movies===null||movies===void 0?void 0:movies.map(function(item,index){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:item.movieName}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Button,{variant:\"success\",onClick:function onClick(){return fetchTickets(item.movieName);},children:\"Booking\"})})]},index);})})]})})]});}","map":{"version":3,"names":["React","useEffect","useState","useNavigate","NavbarComp","createAxios","getTokenFromLocalStorage","Table","Button","Container","styled","section","LeftContainer","div","RightContainer","AllTicket","navigate","token","error","setError","errorMessage","setErrorMessage","user","localStorage","getItem","parsedUser","JSON","parse","userRole","roles","movies","setMovies","tickets","setTickets","fetchMovies","accessToken","apiUrl","authAxios","get","validateStatus","status","data","fetchTickets","movieName","map","item","index","loginId","theatreName","noOfTickets","Array","isArray","seatNumber","join"],"sources":["C:/Users/LENOVO/Downloads/frontend/src/Components/Admin/Bookings.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { useNavigate } from 'react-router-dom'\r\nimport NavbarComp from '../Navbar/NavbarComp'\r\nimport { createAxios, getTokenFromLocalStorage } from '../../Hooks/UseAxios'\r\nimport Table from 'react-bootstrap/Table'\r\nimport styled from 'styled-components/macro'\r\nimport 'react-pro-sidebar/dist/css/styles.css'\r\nimport { Button } from 'react-bootstrap'\r\n\r\n\r\nconst Container = styled.section`\r\n  /* border: 1px solid olive; */\r\n  max-width: 1000px;\r\n  margin: 0 auto;\r\n  box-sizing: border-box;\r\n  margin-top: 8rem;\r\n`\r\n\r\nconst LeftContainer = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  padding: 0 1rem;\r\n  align-items: flex-end;\r\n  float: left;\r\n  width: 50%;\r\n  height: 100%;\r\n  margin-top: 8rem;\r\n\r\n  @media (max-width: 800px) {\r\n    width: 100%;\r\n  }\r\n`\r\n\r\nconst RightContainer = styled.div`\r\n  float: right;\r\n  width: 50%;\r\n  display: flex;\r\n  justify-content: center;\r\n  margin-top: 8rem;\r\n  align-items: center;\r\n  /* border: 1px solid purple; */\r\n  height: 100%;\r\n  img {\r\n    width: 100%;\r\n    max-width: 800px;\r\n  }\r\n\r\n  @media (max-width: 800px) {\r\n    display: none;\r\n      \r\n  }\r\n`\r\n\r\nexport default function AllTicket() {\r\n  const navigate = useNavigate()\r\n  const token = getTokenFromLocalStorage()\r\n  const [error, setError] = useState(false)\r\n  const [errorMessage, setErrorMessage] = useState('')\r\n\r\n  //check user role\r\n  const user = localStorage.getItem('user')\r\n  const parsedUser = JSON.parse(user)\r\n  const userRole = parsedUser?.roles[0]\r\n  useEffect(() => {\r\n    if (!user || userRole !== 'ROLE_ADMIN') {\r\n      navigate('/')\r\n    }\r\n  }, [userRole])\r\n  const [movies, setMovies] = useState([]);\r\n  const [tickets, setTickets]= useState([]);\r\n\r\n  // useEffect(() => {\r\n  //   fetchMovies();\r\n  // }, []);\r\n\r\n  const fetchMovies = async () => {\r\n  //  try {\r\n  //   const response = await axios.get('http://localhost:8081/api/v1.0/moviebooking/all')\r\n  //   setMovies(response.data?.data);\r\n  //  } catch(error){\r\n  //   console.log(error);\r\n  //  }\r\n  const accessToken = parsedUser?.accessToken\r\n  //console.log(accessToken)\r\n  const apiUrl = 'http://localhost:8081/api/v1.0/moviebooking'\r\n  const authAxios = createAxios(apiUrl, accessToken)\r\n\r\n\r\n  const data = await authAxios.get('/all', {\r\n    validateStatus: function(status){\r\n      return status<500;\r\n    }\r\n  })\r\n  setMovies(data?.data);\r\n  };\r\n\r\n  useEffect(() => {\r\n     fetchMovies()\r\n  }, [])\r\n\r\n  const fetchTickets = async(movieName) => {\r\n    const accessToken = parsedUser?.accessToken\r\n  //console.log(accessToken)\r\n  const apiUrl = 'https://movieapp-danish.azurewebsites.net/'\r\n  const authAxios = createAxios(apiUrl, accessToken)\r\n\r\n\r\n  const data = await authAxios.get(`/getallbookedtickets/${movieName}`, {\r\n    validateStatus: function(status){\r\n      return status<500;\r\n    }\r\n  })\r\n  setTickets(data?.data);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <NavbarComp />\r\n        <RightContainer>\r\n        <Table striped bordered hover variant='light'>\r\n          <thead>\r\n            <tr>\r\n              <th>ID</th>\r\n              <th>Movie Name</th>\r\n              <th>Theatre Name</th>\r\n              <th>Tickets </th>\r\n              <th>Seat Numbers</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {tickets?.map((item,index) => {\r\n              return (\r\n                <tr key={index}>\r\n                  <td>{item.loginId}</td>\r\n                  <td>{item.movieName}</td>\r\n                  <td>{item.theatreName}</td>\r\n                  <td>{item.noOfTickets}</td>\r\n                  <td>\r\n                    {Array.isArray(item.seatNumber)\r\n                        ? item.seatNumber.join(', ')\r\n                        : 'N/A'}\r\n                  </td>\r\n                </tr>\r\n              )\r\n            })}\r\n          </tbody>\r\n        </Table>\r\n        </RightContainer>\r\n        <LeftContainer>\r\n        <Table striped bordered hover variant='light'>\r\n          <thead>\r\n            <tr>\r\n              <th>Movie Name</th>\r\n              <th>Action</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {movies?.map((item,index) => {\r\n              return (\r\n                <tr key={index}>\r\n                  <td>{item.movieName}</td>\r\n                  <td>\r\n                    <Button\r\n                        variant=\"success\"\r\n                        onClick={() => fetchTickets(item.movieName)}\r\n                    >\r\n                        Booking\r\n                    </Button>\r\n                  </td>\r\n                </tr>\r\n              )\r\n            })}\r\n          </tbody>\r\n        </Table>\r\n        </LeftContainer>\r\n    </>\r\n  )\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}