{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/LENOVO/Downloads/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/LENOVO/Downloads/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"C:/Users/LENOVO/Downloads/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/LENOVO/Downloads/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/LENOVO/Downloads/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _styled from\"styled-components\";import React,{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import NavbarComp from'../Navbar/NavbarComp';import{createAxios,getTokenFromLocalStorage}from'../../Hooks/UseAxios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Container=_styled.section.withConfig({displayName:\"BookTickets__Container\",componentId:\"sc-16m50cn-0\"})([\"max-width:1000px;margin:0 auto;padding-top:5rem;box-sizing:border-box;\"]);export default function BookTickets(){var navigate=useNavigate();var token=getTokenFromLocalStorage();var _useState=useState({loginId:'',movieName:'',theatreName:'',noOfTickets:'',seatNumber:[]}),_useState2=_slicedToArray(_useState,2),ticket=_useState2[0],setTicket=_useState2[1];//check user role\nvar user=localStorage.getItem('user');var parsedUser=JSON.parse(user);var userRole=parsedUser===null||parsedUser===void 0?void 0:parsedUser.roles[0];useEffect(function(){if(!user||userRole!=='ROLE_USER'){navigate('/');}},[userRole]);var handleChange=function handleChange(e){var _e$target=e.target,id=_e$target.id,value=_e$target.value;if(id==='seatNumber'){var seatNumber=value.split(\",\").map(function(num){return num.trim();});setTicket(function(prevTicket){return _objectSpread(_objectSpread({},prevTicket),{},_defineProperty({},id,seatNumber));});}else{setTicket(function(prevTicket){return _objectSpread(_objectSpread({},prevTicket),{},_defineProperty({},id,value));});}};var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(movieName){var token,apiUrl,authAxios,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:// axios\n//   .post(`http://localhost:8081/api/v1.0/moviebooking/${movieName}/add`, ticket)\n//   .then((response) => {\n//     console.log(response.data);\n//     alert(\"Ticket Booked!\")\n//   })\n//   .catch((error) =>{\n//     console.error(error);\n//   });\ntoken=parsedUser.accessToken;console.log(parsedUser);//const apiUrl = 'http://localhost:8081/api/v1.0/moviebooking'\napiUrl='https://movieapp-danish.azurewebsites.net';authAxios=createAxios(apiUrl,token);_context.next=6;return authAxios.post(\"/\".concat(movieName,\"/add\"),ticket);case 6:data=_context.sent;alert('Tickets Booked!');case 8:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(NavbarComp,{}),/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"mt-5\",children:\"Book Ticket\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"row g-3 mt-5\",noValidate:true,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"loginId\",className:\"form-label\",children:\"Login ID\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",id:\"loginId\",value:ticket.loginId,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"movieName\",className:\"form-label\",children:\"Movie Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",id:\"movieName\",value:ticket.movieName,onChange:handleChange,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"valid-feedback\",children:\"Looks good!\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"theatreName\",className:\"form-label\",children:\"Theatre Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",id:\"theatreName\",value:ticket.theatreName,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"noOfTickets\",className:\"form-label\",children:\"Number of Tickets\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",id:\"noOfTickets\",value:ticket.noOfTickets,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"seatNumber\",className:\"form-label\",children:\"Seat Numbers\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",value:ticket.seatNumber,id:\"seatNumber\",onChange:handleChange,required:true})]}),/*#__PURE__*/_jsx(\"div\",{className:\"col-12\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",onClick:function onClick(){return handleSubmit(ticket.movieName);},children:\"Book\"})})]})]})]});}","map":{"version":3,"names":["React","useEffect","useState","useNavigate","NavbarComp","createAxios","getTokenFromLocalStorage","Container","styled","section","BookTickets","navigate","token","loginId","movieName","theatreName","noOfTickets","seatNumber","ticket","setTicket","user","localStorage","getItem","parsedUser","JSON","parse","userRole","roles","handleChange","e","target","id","value","split","map","num","trim","prevTicket","handleSubmit","accessToken","console","log","apiUrl","authAxios","post","data","alert"],"sources":["C:/Users/LENOVO/Downloads/frontend/src/Components/User/BookTickets.js"],"sourcesContent":["import React,{ useEffect, useState }  from 'react'\r\nimport { useNavigate } from 'react-router-dom'\r\nimport NavbarComp from '../Navbar/NavbarComp'\r\nimport { createAxios, getTokenFromLocalStorage } from '../../Hooks/UseAxios'\r\nimport styled from 'styled-components/macro'\r\n\r\nconst Container = styled.section`\r\n  /* border: 1px solid olive; */\r\n  max-width: 1000px;\r\n  margin: 0 auto;\r\n  padding-top: 5rem;\r\n  box-sizing: border-box;\r\n  `\r\n\r\nexport default function BookTickets(){\r\n    const navigate = useNavigate()\r\n    const token = getTokenFromLocalStorage()\r\n    const [ticket,setTicket] = useState({\r\n      loginId: '',\r\n      movieName: '',\r\n      theatreName: '',\r\n      noOfTickets: '',\r\n      seatNumber: []\r\n    })\r\n\r\n  //check user role\r\n  const user = localStorage.getItem('user')\r\n  const parsedUser = JSON.parse(user)\r\n  const userRole = parsedUser?.roles[0]\r\n  useEffect(() => {\r\n    if (!user || userRole !== 'ROLE_USER') {\r\n      navigate('/')\r\n    }\r\n  }, [userRole])\r\n\r\n  const handleChange = (e) => {\r\n    const { id, value} = e.target;\r\n    if(id === 'seatNumber'){\r\n      const seatNumber = value.split(\",\").map((num) => num.trim());\r\n      setTicket((prevTicket) => ({...prevTicket, [id]: seatNumber}));\r\n    }else{\r\n      setTicket((prevTicket) => ({ ...prevTicket, [id]: value}));\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (movieName) => {\r\n    // axios\r\n    //   .post(`http://localhost:8081/api/v1.0/moviebooking/${movieName}/add`, ticket)\r\n    //   .then((response) => {\r\n    //     console.log(response.data);\r\n    //     alert(\"Ticket Booked!\")\r\n    //   })\r\n    //   .catch((error) =>{\r\n    //     console.error(error);\r\n    //   });\r\n\r\n    const token = parsedUser.accessToken\r\n    console.log(parsedUser)\r\n    //const apiUrl = 'http://localhost:8081/api/v1.0/moviebooking'\r\n    const apiUrl = 'https://movieapp-danish.azurewebsites.net'\r\n    const authAxios = createAxios(apiUrl, token)\r\n\r\n    const data = await authAxios.post(`/${movieName}/add`, ticket)\r\n    alert('Tickets Booked!');\r\n  };\r\n\r\n  return(\r\n    <>\r\n    <NavbarComp />\r\n    <Container>\r\n    <h2 className='mt-5'>Book Ticket</h2>\r\n        <form className='row g-3 mt-5' noValidate>\r\n        <div className='col-md-6'>\r\n            <label htmlFor='loginId' className='form-label'>\r\n              Login ID\r\n            </label>\r\n            <input\r\n              type='text'\r\n              className='form-control'\r\n              id='loginId'\r\n              value={ticket.loginId}\r\n              onChange={handleChange}\r\n              required\r\n            />\r\n          </div>\r\n          <div className='col-md-6'>\r\n            <label htmlFor='movieName' className='form-label'>\r\n              Movie Name\r\n            </label>\r\n            <input\r\n              type='text'\r\n              className='form-control'\r\n              id='movieName'\r\n              value={ticket.movieName}\r\n              onChange={handleChange}\r\n              required\r\n            />\r\n            <div className='valid-feedback'>Looks good!</div>\r\n          </div>\r\n          <div className='col-md-6'>\r\n            <label htmlFor='theatreName' className='form-label'>\r\n              Theatre Name\r\n            </label>\r\n            <input\r\n              type='text'\r\n              className='form-control'\r\n              id='theatreName'\r\n              value={ticket.theatreName}\r\n              onChange={handleChange}\r\n              required\r\n            />\r\n          </div>\r\n          <div className='col-md-6'>\r\n            <label htmlFor='noOfTickets' className='form-label'>\r\n              Number of Tickets\r\n            </label>\r\n            <input\r\n              type='text'\r\n              className='form-control'\r\n              id='noOfTickets'\r\n              value={ticket.noOfTickets}\r\n              onChange={handleChange}\r\n              required\r\n            />\r\n          </div>\r\n          <div className='col-md-6'>\r\n            <label htmlFor='seatNumber' className='form-label'>\r\n              Seat Numbers\r\n            </label>\r\n            <input\r\n              type='text'\r\n              className='form-control'\r\n              value={ticket.seatNumber}\r\n              id='seatNumber'\r\n              onChange={handleChange}\r\n              required\r\n            />\r\n          </div>\r\n\r\n          {/* <ErrorBox>{error && errorMessage}</ErrorBox> */}\r\n          <div className='col-12'>\r\n            <button\r\n              type='submit'\r\n              className='btn btn-primary'\r\n              onClick={() => handleSubmit(ticket.movieName)}\r\n            >\r\n              Book\r\n            </button>\r\n          </div>\r\n        </form>\r\n    </Container>\r\n    \r\n    </>\r\n  )\r\n}"],"mappings":"gpBAAA,MAAOA,MAAP,EAAeC,SAAf,CAA0BC,QAA1B,KAA2C,OAA3C,CACA,OAASC,WAAT,KAA4B,kBAA5B,CACA,MAAOC,WAAP,KAAuB,sBAAvB,CACA,OAASC,WAAT,CAAsBC,wBAAtB,KAAsD,sBAAtD,C,6IAGA,GAAMC,UAAS,CAAGC,OAAM,CAACC,OAAV,0JAAf,CAQA,cAAe,SAASC,YAAT,EAAsB,CACjC,GAAMC,SAAQ,CAAGR,WAAW,EAA5B,CACA,GAAMS,MAAK,CAAGN,wBAAwB,EAAtC,CACA,cAA2BJ,QAAQ,CAAC,CAClCW,OAAO,CAAE,EADyB,CAElCC,SAAS,CAAE,EAFuB,CAGlCC,WAAW,CAAE,EAHqB,CAIlCC,WAAW,CAAE,EAJqB,CAKlCC,UAAU,CAAE,EALsB,CAAD,CAAnC,wCAAOC,MAAP,eAAcC,SAAd,eAQF;AACA,GAAMC,KAAI,CAAGC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAb,CACA,GAAMC,WAAU,CAAGC,IAAI,CAACC,KAAL,CAAWL,IAAX,CAAnB,CACA,GAAMM,SAAQ,CAAGH,UAAH,SAAGA,UAAH,iBAAGA,UAAU,CAAEI,KAAZ,CAAkB,CAAlB,CAAjB,CACA1B,SAAS,CAAC,UAAM,CACd,GAAI,CAACmB,IAAD,EAASM,QAAQ,GAAK,WAA1B,CAAuC,CACrCf,QAAQ,CAAC,GAAD,CAAR,CACD,CACF,CAJQ,CAIN,CAACe,QAAD,CAJM,CAAT,CAMA,GAAME,aAAY,CAAG,QAAfA,aAAe,CAACC,CAAD,CAAO,CAC1B,cAAqBA,CAAC,CAACC,MAAvB,CAAQC,EAAR,WAAQA,EAAR,CAAYC,KAAZ,WAAYA,KAAZ,CACA,GAAGD,EAAE,GAAK,YAAV,CAAuB,CACrB,GAAMd,WAAU,CAAGe,KAAK,CAACC,KAAN,CAAY,GAAZ,EAAiBC,GAAjB,CAAqB,SAACC,GAAD,QAASA,IAAG,CAACC,IAAJ,EAAT,EAArB,CAAnB,CACAjB,SAAS,CAAC,SAACkB,UAAD,wCAAqBA,UAArB,wBAAkCN,EAAlC,CAAuCd,UAAvC,IAAD,CAAT,CACD,CAHD,IAGK,CACHE,SAAS,CAAC,SAACkB,UAAD,wCAAsBA,UAAtB,wBAAmCN,EAAnC,CAAwCC,KAAxC,IAAD,CAAT,CACD,CACF,CARD,CAUA,GAAMM,aAAY,4FAAG,iBAAOxB,SAAP,oJACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEMF,KAXa,CAWLW,UAAU,CAACgB,WAXN,CAYnBC,OAAO,CAACC,GAAR,CAAYlB,UAAZ,EACA;AACMmB,MAda,CAcJ,2CAdI,CAebC,SAfa,CAeDtC,WAAW,CAACqC,MAAD,CAAS9B,KAAT,CAfV,uBAiBA+B,UAAS,CAACC,IAAV,YAAmB9B,SAAnB,SAAoCI,MAApC,CAjBA,QAiBb2B,IAjBa,eAkBnBC,KAAK,CAAC,iBAAD,CAAL,CAlBmB,sDAAH,kBAAZR,aAAY,4CAAlB,CAqBA,mBACE,wCACA,KAAC,UAAD,IADA,cAEA,MAAC,SAAD,yBACA,WAAI,SAAS,CAAC,MAAd,yBADA,cAEI,cAAM,SAAS,CAAC,cAAhB,CAA+B,UAAU,KAAzC,wBACA,aAAK,SAAS,CAAC,UAAf,wBACI,cAAO,OAAO,CAAC,SAAf,CAAyB,SAAS,CAAC,YAAnC,sBADJ,cAII,cACE,IAAI,CAAC,MADP,CAEE,SAAS,CAAC,cAFZ,CAGE,EAAE,CAAC,SAHL,CAIE,KAAK,CAAEpB,MAAM,CAACL,OAJhB,CAKE,QAAQ,CAAEe,YALZ,CAME,QAAQ,KANV,EAJJ,GADA,cAcE,aAAK,SAAS,CAAC,UAAf,wBACE,cAAO,OAAO,CAAC,WAAf,CAA2B,SAAS,CAAC,YAArC,wBADF,cAIE,cACE,IAAI,CAAC,MADP,CAEE,SAAS,CAAC,cAFZ,CAGE,EAAE,CAAC,WAHL,CAIE,KAAK,CAAEV,MAAM,CAACJ,SAJhB,CAKE,QAAQ,CAAEc,YALZ,CAME,QAAQ,KANV,EAJF,cAYE,YAAK,SAAS,CAAC,gBAAf,yBAZF,GAdF,cA4BE,aAAK,SAAS,CAAC,UAAf,wBACE,cAAO,OAAO,CAAC,aAAf,CAA6B,SAAS,CAAC,YAAvC,0BADF,cAIE,cACE,IAAI,CAAC,MADP,CAEE,SAAS,CAAC,cAFZ,CAGE,EAAE,CAAC,aAHL,CAIE,KAAK,CAAEV,MAAM,CAACH,WAJhB,CAKE,QAAQ,CAAEa,YALZ,CAME,QAAQ,KANV,EAJF,GA5BF,cAyCE,aAAK,SAAS,CAAC,UAAf,wBACE,cAAO,OAAO,CAAC,aAAf,CAA6B,SAAS,CAAC,YAAvC,+BADF,cAIE,cACE,IAAI,CAAC,MADP,CAEE,SAAS,CAAC,cAFZ,CAGE,EAAE,CAAC,aAHL,CAIE,KAAK,CAAEV,MAAM,CAACF,WAJhB,CAKE,QAAQ,CAAEY,YALZ,CAME,QAAQ,KANV,EAJF,GAzCF,cAsDE,aAAK,SAAS,CAAC,UAAf,wBACE,cAAO,OAAO,CAAC,YAAf,CAA4B,SAAS,CAAC,YAAtC,0BADF,cAIE,cACE,IAAI,CAAC,MADP,CAEE,SAAS,CAAC,cAFZ,CAGE,KAAK,CAAEV,MAAM,CAACD,UAHhB,CAIE,EAAE,CAAC,YAJL,CAKE,QAAQ,CAAEW,YALZ,CAME,QAAQ,KANV,EAJF,GAtDF,cAqEE,YAAK,SAAS,CAAC,QAAf,uBACE,eACE,IAAI,CAAC,QADP,CAEE,SAAS,CAAC,iBAFZ,CAGE,OAAO,CAAE,yBAAMU,aAAY,CAACpB,MAAM,CAACJ,SAAR,CAAlB,EAHX,kBADF,EArEF,GAFJ,GAFA,GADF,CAwFD"},"metadata":{},"sourceType":"module"}