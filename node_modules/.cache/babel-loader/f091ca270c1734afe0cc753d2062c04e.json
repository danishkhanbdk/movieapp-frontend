{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/LENOVO/Downloads/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/LENOVO/Downloads/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/LENOVO/Downloads/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _styled from\"styled-components\";import React,{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import NavbarComp from'../Navbar/NavbarComp';import axios from'axios';import{createAxios,getTokenFromLocalStorage}from'../../Hooks/UseAxios';import Table from'react-bootstrap/Table';import'react-pro-sidebar/dist/css/styles.css';import{Button}from'react-bootstrap';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Container=_styled.section.withConfig({displayName:\"DeleteMovie__Container\",componentId:\"sc-hupy32-0\"})([\"max-width:1000px;margin:0 auto;box-sizing:border-box;margin-top:8rem;\"]);export default function DeleteMovie(){var navigate=useNavigate();var token=getTokenFromLocalStorage();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),errorMessage=_useState4[0],setErrorMessage=_useState4[1];//check user role\nvar user=localStorage.getItem('user');var parsedUser=JSON.parse(user);var userRole=parsedUser===null||parsedUser===void 0?void 0:parsedUser.roles[0];useEffect(function(){if(!user||userRole!=='ROLE_ADMIN'){navigate('/');}},[userRole]);var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),movies=_useState6[0],setMovies=_useState6[1];// useEffect(() => {\n//   fetchMovies();\n// }, []);\nvar fetchMovies=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var accessToken,apiUrl,authAxios,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0://  try {\n//   const response = await axios.get('http://localhost:8081/api/v1.0/moviebooking/all')\n//   setMovies(response.data?.data);\n//  } catch(error){\n//   console.log(error);\n//  }\naccessToken=parsedUser===null||parsedUser===void 0?void 0:parsedUser.accessToken;//console.log(accessToken)\n//const apiUrl = 'http://localhost:8081/api/v1.0/moviebooking'\napiUrl='https://movieapp-danish.azurewebsites.net/';authAxios=createAxios(apiUrl,accessToken);_context.next=5;return authAxios.get('/all',{validateStatus:function validateStatus(status){return status<500;}});case 5:data=_context.sent;setMovies(data===null||data===void 0?void 0:data.data);case 7:case\"end\":return _context.stop();}}},_callee);}));return function fetchMovies(){return _ref.apply(this,arguments);};}();useEffect(function(){fetchMovies();},[]);var deleteMovie=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(movieName){var token,apiUrl,authAxios,data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:// try {\n//   await axios.delete(`http://localhost:8081/api/v1.0/moviebooking/${movieName}/delete`); // Replace with your backend API endpoint\n//   fetchMovies();\n// } catch (error) {\n//   console.error(error);\n//   // Handle error, e.g., show an error message\n// }\ntoken=parsedUser.accessToken;console.log(parsedUser);//const apiUrl = 'http://localhost:8081/api/v1.0/moviebooking'\napiUrl='https://movieapp-danish.azurewebsites.net/';authAxios=createAxios(apiUrl,token);_context2.next=6;return authAxios.delete(\"/\".concat(movieName,\"/delete\"));case 6:data=_context2.sent;case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function deleteMovie(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(NavbarComp,{}),/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,hover:true,variant:\"light\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Movie Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Theatre Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Number Of Tickets Available\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Tickets Status\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Action\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:movies===null||movies===void 0?void 0:movies.map(function(item,index){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:item.movieName}),/*#__PURE__*/_jsx(\"td\",{children:item.theatreName}),/*#__PURE__*/_jsx(\"td\",{children:item.noOfTicketsAvailable}),/*#__PURE__*/_jsx(\"td\",{children:item.ticketsStatus}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Button,{variant:\"danger\",onClick:function onClick(){return deleteMovie(item.movieName);},children:\"Delete\"})})]},index);})})]})})]});}","map":{"version":3,"names":["React","useEffect","useState","useNavigate","NavbarComp","axios","createAxios","getTokenFromLocalStorage","Table","Button","Container","styled","section","DeleteMovie","navigate","token","error","setError","errorMessage","setErrorMessage","user","localStorage","getItem","parsedUser","JSON","parse","userRole","roles","movies","setMovies","fetchMovies","accessToken","apiUrl","authAxios","get","validateStatus","status","data","deleteMovie","movieName","console","log","delete","map","item","index","theatreName","noOfTicketsAvailable","ticketsStatus"],"sources":["C:/Users/LENOVO/Downloads/frontend/src/Components/Admin/DeleteMovie.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { useNavigate } from 'react-router-dom'\r\nimport NavbarComp from '../Navbar/NavbarComp'\r\nimport axios from 'axios';\r\nimport { createAxios, getTokenFromLocalStorage } from '../../Hooks/UseAxios'\r\nimport Table from 'react-bootstrap/Table'\r\nimport styled from 'styled-components/macro'\r\nimport 'react-pro-sidebar/dist/css/styles.css'\r\nimport { Button } from 'react-bootstrap';\r\n\r\nconst Container = styled.section`\r\n  /* border: 1px solid olive; */\r\n  max-width: 1000px;\r\n  margin: 0 auto;\r\n  box-sizing: border-box;\r\n  margin-top: 8rem;\r\n`\r\n\r\nexport default function DeleteMovie() {\r\n  const navigate = useNavigate()\r\n  const token = getTokenFromLocalStorage()\r\n  const [error, setError] = useState(false)\r\n  const [errorMessage, setErrorMessage] = useState('')\r\n\r\n  //check user role\r\n  const user = localStorage.getItem('user')\r\n  const parsedUser = JSON.parse(user)\r\n  const userRole = parsedUser?.roles[0]\r\n  useEffect(() => {\r\n    if (!user || userRole !== 'ROLE_ADMIN') {\r\n      navigate('/')\r\n    }\r\n  }, [userRole])\r\n\r\n  const [movies, setMovies] = useState([]);\r\n\r\n  // useEffect(() => {\r\n  //   fetchMovies();\r\n  // }, []);\r\n\r\n  const fetchMovies = async () => {\r\n  //  try {\r\n  //   const response = await axios.get('http://localhost:8081/api/v1.0/moviebooking/all')\r\n  //   setMovies(response.data?.data);\r\n  //  } catch(error){\r\n  //   console.log(error);\r\n  //  }\r\n   const accessToken = parsedUser?.accessToken\r\n    //console.log(accessToken)\r\n    //const apiUrl = 'http://localhost:8081/api/v1.0/moviebooking'\r\n    const apiUrl = 'https://movieapp-danish.azurewebsites.net/'\r\n    const authAxios = createAxios(apiUrl, accessToken)\r\n\r\n\r\n    const data = await authAxios.get('/all', {\r\n      validateStatus: function(status){\r\n        return status<500;\r\n      }\r\n    })\r\n    setMovies(data?.data);\r\n  };\r\n\r\n  useEffect(() => {\r\n     fetchMovies()\r\n  }, [])\r\n\r\n  const deleteMovie = async (movieName) => {\r\n    // try {\r\n    //   await axios.delete(`http://localhost:8081/api/v1.0/moviebooking/${movieName}/delete`); // Replace with your backend API endpoint\r\n    //   fetchMovies();\r\n    // } catch (error) {\r\n    //   console.error(error);\r\n    //   // Handle error, e.g., show an error message\r\n    // }\r\n    const token = parsedUser.accessToken\r\n    console.log(parsedUser)\r\n    //const apiUrl = 'http://localhost:8081/api/v1.0/moviebooking'\r\n    const apiUrl = 'https://movieapp-danish.azurewebsites.net/'\r\n    const authAxios = createAxios(apiUrl, token)\r\n\r\n    const data = await authAxios.delete(`/${movieName}/delete`)\r\n\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <NavbarComp />\r\n      <Container>\r\n        <Table striped bordered hover variant='light'>\r\n          <thead>\r\n            <tr>\r\n              <th>Movie Name</th>\r\n              <th>Theatre Name</th>\r\n              <th>Number Of Tickets Available</th>\r\n              <th>Tickets Status</th>\r\n              <th>Action</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {movies?.map((item,index) => {\r\n              return (\r\n                <tr key={index}>\r\n                  <td>{item.movieName}</td>\r\n                  <td>{item.theatreName}</td>\r\n                  <td>{item.noOfTicketsAvailable}</td>\r\n                  <td>{item.ticketsStatus}</td>\r\n                  <td>\r\n                    <Button\r\n                        variant=\"danger\"\r\n                        onClick={() => deleteMovie(item.movieName)}\r\n                    >\r\n                      Delete\r\n                    </Button>\r\n                  </td>\r\n                </tr>\r\n              )\r\n            })}\r\n          </tbody>\r\n        </Table>\r\n      </Container>\r\n    </>\r\n  )\r\n}\r\n"],"mappings":"+ZAAA,MAAOA,MAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,OAASC,WAAT,KAA4B,kBAA5B,CACA,MAAOC,WAAP,KAAuB,sBAAvB,CACA,MAAOC,MAAP,KAAkB,OAAlB,CACA,OAASC,WAAT,CAAsBC,wBAAtB,KAAsD,sBAAtD,CACA,MAAOC,MAAP,KAAkB,uBAAlB,CAEA,MAAO,uCAAP,CACA,OAASC,MAAT,KAAuB,iBAAvB,C,6IAEA,GAAMC,UAAS,CAAGC,OAAM,CAACC,OAAV,wJAAf,CAQA,cAAe,SAASC,YAAT,EAAuB,CACpC,GAAMC,SAAQ,CAAGX,WAAW,EAA5B,CACA,GAAMY,MAAK,CAAGR,wBAAwB,EAAtC,CACA,cAA0BL,QAAQ,CAAC,KAAD,CAAlC,wCAAOc,KAAP,eAAcC,QAAd,eACA,eAAwCf,QAAQ,CAAC,EAAD,CAAhD,yCAAOgB,YAAP,eAAqBC,eAArB,eAEA;AACA,GAAMC,KAAI,CAAGC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAb,CACA,GAAMC,WAAU,CAAGC,IAAI,CAACC,KAAL,CAAWL,IAAX,CAAnB,CACA,GAAMM,SAAQ,CAAGH,UAAH,SAAGA,UAAH,iBAAGA,UAAU,CAAEI,KAAZ,CAAkB,CAAlB,CAAjB,CACA1B,SAAS,CAAC,UAAM,CACd,GAAI,CAACmB,IAAD,EAASM,QAAQ,GAAK,YAA1B,CAAwC,CACtCZ,QAAQ,CAAC,GAAD,CAAR,CACD,CACF,CAJQ,CAIN,CAACY,QAAD,CAJM,CAAT,CAMA,eAA4BxB,QAAQ,CAAC,EAAD,CAApC,yCAAO0B,MAAP,eAAeC,SAAf,eAEA;AACA;AACA;AAEA,GAAMC,YAAW,4FAAG,2KACpB;AACA;AACA;AACA;AACA;AACA;AACOC,WAPa,CAOCR,UAPD,SAOCA,UAPD,iBAOCA,UAAU,CAAEQ,WAPb,CAQlB;AACA;AACMC,MAVY,CAUH,4CAVG,CAWZC,SAXY,CAWA3B,WAAW,CAAC0B,MAAD,CAASD,WAAT,CAXX,uBAcCE,UAAS,CAACC,GAAV,CAAc,MAAd,CAAsB,CACvCC,cAAc,CAAE,wBAASC,MAAT,CAAgB,CAC9B,MAAOA,OAAM,CAAC,GAAd,CACD,CAHsC,CAAtB,CAdD,QAcZC,IAdY,eAmBlBR,SAAS,CAACQ,IAAD,SAACA,IAAD,iBAACA,IAAI,CAAEA,IAAP,CAAT,CAnBkB,sDAAH,kBAAXP,YAAW,0CAAjB,CAsBA7B,SAAS,CAAC,UAAM,CACb6B,WAAW,GACb,CAFQ,CAEN,EAFM,CAAT,CAIA,GAAMQ,YAAW,6FAAG,kBAAOC,SAAP,wJAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACMxB,KARY,CAQJQ,UAAU,CAACQ,WARP,CASlBS,OAAO,CAACC,GAAR,CAAYlB,UAAZ,EACA;AACMS,MAXY,CAWH,4CAXG,CAYZC,SAZY,CAYA3B,WAAW,CAAC0B,MAAD,CAASjB,KAAT,CAZX,wBAcCkB,UAAS,CAACS,MAAV,YAAqBH,SAArB,YAdD,QAcZF,IAdY,wEAAH,kBAAXC,YAAW,6CAAjB,CAkBA,mBACE,wCACE,KAAC,UAAD,IADF,cAEE,KAAC,SAAD,wBACE,MAAC,KAAD,EAAO,OAAO,KAAd,CAAe,QAAQ,KAAvB,CAAwB,KAAK,KAA7B,CAA8B,OAAO,CAAC,OAAtC,wBACE,oCACE,mCACE,kCADF,cAEE,oCAFF,cAGE,mDAHF,cAIE,sCAJF,cAKE,8BALF,GADF,EADF,cAUE,uBACGV,MADH,SACGA,MADH,iBACGA,MAAM,CAAEe,GAAR,CAAY,SAACC,IAAD,CAAMC,KAAN,CAAgB,CAC3B,mBACE,mCACE,oBAAKD,IAAI,CAACL,SAAV,EADF,cAEE,oBAAKK,IAAI,CAACE,WAAV,EAFF,cAGE,oBAAKF,IAAI,CAACG,oBAAV,EAHF,cAIE,oBAAKH,IAAI,CAACI,aAAV,EAJF,cAKE,iCACE,KAAC,MAAD,EACI,OAAO,CAAC,QADZ,CAEI,OAAO,CAAE,yBAAMV,YAAW,CAACM,IAAI,CAACL,SAAN,CAAjB,EAFb,oBADF,EALF,GAASM,KAAT,CADF,CAgBD,CAjBA,CADH,EAVF,GADF,EAFF,GADF,CAsCD"},"metadata":{},"sourceType":"module"}